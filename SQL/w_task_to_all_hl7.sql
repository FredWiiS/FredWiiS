CREATE 
    ALGORITHM = UNDEFINED 
    DEFINER = `wiis`@`%` 
    SQL SECURITY DEFINER
VIEW `w_task_to_all_hl7` AS
    SELECT 
        `w_task_to_hl7_document`.`study_id` AS `study_id`,
        `w_task_to_hl7_document`.`study_accession_number` AS `study_accession_number`,
        `w_task_to_hl7_document`.`study_scheduled_datetime` AS `study_scheduled_datetime`,
        `w_task_to_hl7_document`.`study_modality_code` AS `study_modality_code`,
        `w_task_to_hl7_document`.`study_study_type_code` AS `study_study_type_code`,
        `w_task_to_hl7_document`.`study_location_code` AS `study_location_code`,
        `w_task_to_hl7_document`.`study_study_status_code` AS `study_study_status_code`,
        `w_task_to_hl7_document`.`study_created_at` AS `study_created_at`,
        `w_task_to_hl7_document`.`study_updated_at` AS `study_updated_at`,
        `w_task_to_hl7_document`.`task_id` AS `task_id`,
        `w_task_to_hl7_document`.`task_action` AS `task_action`,
        `w_task_to_hl7_document`.`task_parameters` AS `task_parameters`,
        `w_task_to_hl7_document`.`task_status` AS `task_status`,
        `w_task_to_hl7_document`.`task_created_at` AS `task_created_at`,
        `w_task_to_hl7_document`.`task_updated_at` AS `task_updated_at`,
        `w_task_to_hl7_document`.`patient_id` AS `patient_id`,
        `w_task_to_hl7_document`.`patient_hl7_patient_id` AS `patient_hl7_patient_id`,
        `w_task_to_hl7_document`.`patient_hl7_patient_patient_id` AS `patient_hl7_patient_patient_id`,
        `w_task_to_hl7_document`.`patient_ticket_number` AS `patient_ticket_number`,
        `w_task_to_hl7_document`.`patient_admit_datetime` AS `patient_admit_datetime`,
        `w_task_to_hl7_document`.`patient_admit_borne_code` AS `patient_admit_borne_code`,
        `w_task_to_hl7_document`.`patient_reason_of_visit_code` AS `patient_reason_of_visit_code`,
        `w_task_to_hl7_document`.`patient_reason_of_visit_label` AS `patient_reason_of_visit_label`,
        `w_task_to_hl7_document`.`patient_last_name` AS `patient_last_name`,
        `w_task_to_hl7_document`.`patient_first_name` AS `patient_first_name`,
        `w_task_to_hl7_document`.`patient_first_name_2` AS `patient_first_name_2`,
        `w_task_to_hl7_document`.`patient_first_name_3` AS `patient_first_name_3`,
        `w_task_to_hl7_document`.`patient_first_name_4` AS `patient_first_name_4`,
        `w_task_to_hl7_document`.`patient_birth_name` AS `patient_birth_name`,
        `w_task_to_hl7_document`.`patient_sex` AS `patient_sex`,
        `w_task_to_hl7_document`.`patient_birthdate` AS `patient_birthdate`,
        `w_task_to_hl7_document`.`patient_street_address` AS `patient_street_address`,
        `w_task_to_hl7_document`.`patient_city` AS `patient_city`,
        `w_task_to_hl7_document`.`patient_state` AS `patient_state`,
        `w_task_to_hl7_document`.`patient_zip_code` AS `patient_zip_code`,
        `w_task_to_hl7_document`.`patient_private_phone_number` AS `patient_private_phone_number`,
        `w_task_to_hl7_document`.`patient_phone_number` AS `patient_phone_number`,
        `w_task_to_hl7_document`.`patient_business_phone_number` AS `patient_business_phone_number`,
        `w_task_to_hl7_document`.`patient_mail` AS `patient_mail`,
        `w_task_to_hl7_document`.`patient_ssn_number` AS `patient_ssn_number`,
        `w_task_to_hl7_document`.`patient_location_code` AS `patient_location_code`,
        `w_task_to_hl7_document`.`patient_patient_status_code` AS `patient_patient_status_code`,
        `w_task_to_hl7_document`.`patient_identity_reliability_code` AS `patient_identity_reliability_code`,
        `w_task_to_hl7_document`.`patient_put_on_hold` AS `patient_put_on_hold`,
        `w_task_to_hl7_document`.`patient_last_called_at` AS `patient_last_called_at`,
        `w_task_to_hl7_document`.`patient_number_of_call` AS `patient_number_of_call`,
        `w_task_to_hl7_document`.`patient_created_at` AS `patient_created_at`,
        `w_task_to_hl7_document`.`patient_updated_at` AS `patient_updated_at`,
        `w_task_to_hl7_document`.`document_id` AS `document_id`,
        `w_task_to_hl7_document`.`document_patient_id` AS `document_patient_id`,
        `w_task_to_hl7_document`.`document_study_id` AS `document_study_id`,
        `w_task_to_hl7_document`.`document_name` AS `document_name`,
        `w_task_to_hl7_document`.`document_file_path` AS `document_file_path`,
        `w_task_to_hl7_document`.`document_alternative_file_path` AS `document_alternative_file_path`,
        `w_task_to_hl7_document`.`document_type_code` AS `document_type_code`,
        `w_task_to_hl7_document`.`document_type_name` AS `document_type_name`,
        `w_task_to_hl7_document`.`document_type_level` AS `document_type_level`,
        `w_task_to_hl7_document`.`document_created_at` AS `document_created_at`,
        `w_task_to_hl7_document`.`document_updated_at` AS `document_updated_at`,
        `w_task_to_hl7_document`.`form_filled_id` AS `form_filled_id`,
        `w_task_to_hl7_document`.`hl7_server_id` AS `hl7_server_id`,
        `w_task_to_hl7_document`.`hl7_server_application` AS `hl7_server_application`,
        `w_task_to_hl7_document`.`hl7_server_facility` AS `hl7_server_facility`,
        `w_task_to_hl7_document`.`hl7_server_ip` AS `hl7_server_ip`,
        `w_task_to_hl7_document`.`hl7_server_port` AS `hl7_server_port`,
        `w_task_to_hl7_document`.`visit_preadmit_number` AS `visit_preadmit_number`,
        `w_task_to_hl7_document`.`visit_admit_number` AS `visit_admit_number`,
        `w_task_to_hl7_document`.`visit_description` AS `visit_description`,
        `w_task_to_hl7_document`.`visit_patient_class` AS `visit_patient_class`,
        `w_task_to_hl7_document`.`identifiant_hl7` AS `identifiant_hl7`
    FROM
        `w_task_to_hl7_document` 
    UNION SELECT 
        `w_task_to_hl7_export_form`.`study_id` AS `study_id`,
        `w_task_to_hl7_export_form`.`study_accession_number` AS `study_accession_number`,
        `w_task_to_hl7_export_form`.`study_scheduled_datetime` AS `study_scheduled_datetime`,
        `w_task_to_hl7_export_form`.`study_modality_code` AS `study_modality_code`,
        `w_task_to_hl7_export_form`.`study_study_type_code` AS `study_study_type_code`,
        `w_task_to_hl7_export_form`.`study_location_code` AS `study_location_code`,
        `w_task_to_hl7_export_form`.`study_study_status_code` AS `study_study_status_code`,
        `w_task_to_hl7_export_form`.`study_created_at` AS `study_created_at`,
        `w_task_to_hl7_export_form`.`study_updated_at` AS `study_updated_at`,
        `w_task_to_hl7_export_form`.`task_id` AS `task_id`,
        `w_task_to_hl7_export_form`.`task_action` AS `task_action`,
        `w_task_to_hl7_export_form`.`task_parameters` AS `task_parameters`,
        `w_task_to_hl7_export_form`.`task_status` AS `task_status`,
        `w_task_to_hl7_export_form`.`task_created_at` AS `task_created_at`,
        `w_task_to_hl7_export_form`.`task_updated_at` AS `task_updated_at`,
        `w_task_to_hl7_export_form`.`patient_id` AS `patient_id`,
        `w_task_to_hl7_export_form`.`patient_hl7_patient_id` AS `patient_hl7_patient_id`,
        `w_task_to_hl7_export_form`.`patient_hl7_patient_patient_id` AS `patient_hl7_patient_patient_id`,
        `w_task_to_hl7_export_form`.`patient_ticket_number` AS `patient_ticket_number`,
        `w_task_to_hl7_export_form`.`patient_admit_datetime` AS `patient_admit_datetime`,
        `w_task_to_hl7_export_form`.`patient_admit_borne_code` AS `patient_admit_borne_code`,
        `w_task_to_hl7_export_form`.`patient_reason_of_visit_code` AS `patient_reason_of_visit_code`,
        `w_task_to_hl7_export_form`.`patient_reason_of_visit_label` AS `patient_reason_of_visit_label`,
        `w_task_to_hl7_export_form`.`patient_last_name` AS `patient_last_name`,
        `w_task_to_hl7_export_form`.`patient_first_name` AS `patient_first_name`,
        `w_task_to_hl7_export_form`.`patient_first_name_2` AS `patient_first_name_2`,
        `w_task_to_hl7_export_form`.`patient_first_name_3` AS `patient_first_name_3`,
        `w_task_to_hl7_export_form`.`patient_first_name_4` AS `patient_first_name_4`,
        `w_task_to_hl7_export_form`.`patient_birth_name` AS `patient_birth_name`,
        `w_task_to_hl7_export_form`.`patient_sex` AS `patient_sex`,
        `w_task_to_hl7_export_form`.`patient_birthdate` AS `patient_birthdate`,
        `w_task_to_hl7_export_form`.`patient_street_address` AS `patient_street_address`,
        `w_task_to_hl7_export_form`.`patient_city` AS `patient_city`,
        `w_task_to_hl7_export_form`.`patient_state` AS `patient_state`,
        `w_task_to_hl7_export_form`.`patient_zip_code` AS `patient_zip_code`,
        `w_task_to_hl7_export_form`.`patient_private_phone_number` AS `patient_private_phone_number`,
        `w_task_to_hl7_export_form`.`patient_phone_number` AS `patient_phone_number`,
        `w_task_to_hl7_export_form`.`patient_business_phone_number` AS `patient_business_phone_number`,
        `w_task_to_hl7_export_form`.`patient_mail` AS `patient_mail`,
        `w_task_to_hl7_export_form`.`patient_ssn_number` AS `patient_ssn_number`,
        `w_task_to_hl7_export_form`.`patient_location_code` AS `patient_location_code`,
        `w_task_to_hl7_export_form`.`patient_patient_status_code` AS `patient_patient_status_code`,
        `w_task_to_hl7_export_form`.`patient_identity_reliability_code` AS `patient_identity_reliability_code`,
        `w_task_to_hl7_export_form`.`patient_put_on_hold` AS `patient_put_on_hold`,
        `w_task_to_hl7_export_form`.`patient_last_called_at` AS `patient_last_called_at`,
        `w_task_to_hl7_export_form`.`patient_number_of_call` AS `patient_number_of_call`,
        `w_task_to_hl7_export_form`.`patient_created_at` AS `patient_created_at`,
        `w_task_to_hl7_export_form`.`patient_updated_at` AS `patient_updated_at`,
        `w_task_to_hl7_export_form`.`document_id` AS `document_id`,
        `w_task_to_hl7_export_form`.`document_patient_id` AS `document_patient_id`,
        `w_task_to_hl7_export_form`.`document_study_id` AS `document_study_id`,
        `w_task_to_hl7_export_form`.`document_name` AS `document_name`,
        `w_task_to_hl7_export_form`.`document_file_path` AS `document_file_path`,
        `w_task_to_hl7_export_form`.`document_alternative_file_path` AS `document_alternative_file_path`,
        `w_task_to_hl7_export_form`.`document_type_code` AS `document_type_code`,
        `w_task_to_hl7_export_form`.`document_type_name` AS `document_type_name`,
        `w_task_to_hl7_export_form`.`document_type_level` AS `document_type_level`,
        `w_task_to_hl7_export_form`.`document_created_at` AS `document_created_at`,
        `w_task_to_hl7_export_form`.`document_updated_at` AS `document_updated_at`,
        `w_task_to_hl7_export_form`.`form_filled_id` AS `form_filled_id`,
        `w_task_to_hl7_export_form`.`hl7_server_id` AS `hl7_server_id`,
        `w_task_to_hl7_export_form`.`hl7_server_application` AS `hl7_server_application`,
        `w_task_to_hl7_export_form`.`hl7_server_facility` AS `hl7_server_facility`,
        `w_task_to_hl7_export_form`.`hl7_server_ip` AS `hl7_server_ip`,
        `w_task_to_hl7_export_form`.`hl7_server_port` AS `hl7_server_port`,
        `w_task_to_hl7_export_form`.`visit_preadmit_number` AS `visit_preadmit_number`,
        `w_task_to_hl7_export_form`.`visit_admit_number` AS `visit_admit_number`,
        `w_task_to_hl7_export_form`.`visit_description` AS `visit_description`,
        `w_task_to_hl7_export_form`.`visit_patient_class` AS `visit_patient_class`,
        `w_task_to_hl7_export_form`.`identifiant_hl7` AS `identifiant_hl7`
    FROM
        `w_task_to_hl7_export_form` 
    UNION SELECT 
        `w_task_to_hl7_admitted`.`study_id` AS `study_id`,
        `w_task_to_hl7_admitted`.`study_accession_number` AS `study_accession_number`,
        `w_task_to_hl7_admitted`.`study_scheduled_datetime` AS `study_scheduled_datetime`,
        `w_task_to_hl7_admitted`.`study_modality_code` AS `study_modality_code`,
        `w_task_to_hl7_admitted`.`study_study_type_code` AS `study_study_type_code`,
        `w_task_to_hl7_admitted`.`study_location_code` AS `study_location_code`,
        `w_task_to_hl7_admitted`.`study_study_status_code` AS `study_study_status_code`,
        `w_task_to_hl7_admitted`.`study_created_at` AS `study_created_at`,
        `w_task_to_hl7_admitted`.`study_updated_at` AS `study_updated_at`,
        `w_task_to_hl7_admitted`.`task_id` AS `task_id`,
        `w_task_to_hl7_admitted`.`task_action` AS `task_action`,
        `w_task_to_hl7_admitted`.`task_parameters` AS `task_parameters`,
        `w_task_to_hl7_admitted`.`task_status` AS `task_status`,
        `w_task_to_hl7_admitted`.`task_created_at` AS `task_created_at`,
        `w_task_to_hl7_admitted`.`task_updated_at` AS `task_updated_at`,
        `w_task_to_hl7_admitted`.`patient_id` AS `patient_id`,
        `w_task_to_hl7_admitted`.`patient_hl7_patient_id` AS `patient_hl7_patient_id`,
        `w_task_to_hl7_admitted`.`patient_hl7_patient_patient_id` AS `patient_hl7_patient_patient_id`,
        `w_task_to_hl7_admitted`.`patient_ticket_number` AS `patient_ticket_number`,
        `w_task_to_hl7_admitted`.`patient_admit_datetime` AS `patient_admit_datetime`,
        `w_task_to_hl7_admitted`.`patient_admit_borne_code` AS `patient_admit_borne_code`,
        `w_task_to_hl7_admitted`.`patient_reason_of_visit_code` AS `patient_reason_of_visit_code`,
        `w_task_to_hl7_admitted`.`patient_reason_of_visit_label` AS `patient_reason_of_visit_label`,
        `w_task_to_hl7_admitted`.`patient_last_name` AS `patient_last_name`,
        `w_task_to_hl7_admitted`.`patient_first_name` AS `patient_first_name`,
        `w_task_to_hl7_admitted`.`patient_first_name_2` AS `patient_first_name_2`,
        `w_task_to_hl7_admitted`.`patient_first_name_3` AS `patient_first_name_3`,
        `w_task_to_hl7_admitted`.`patient_first_name_4` AS `patient_first_name_4`,
        `w_task_to_hl7_admitted`.`patient_birth_name` AS `patient_birth_name`,
        `w_task_to_hl7_admitted`.`patient_sex` AS `patient_sex`,
        `w_task_to_hl7_admitted`.`patient_birthdate` AS `patient_birthdate`,
        `w_task_to_hl7_admitted`.`patient_street_address` AS `patient_street_address`,
        `w_task_to_hl7_admitted`.`patient_city` AS `patient_city`,
        `w_task_to_hl7_admitted`.`patient_state` AS `patient_state`,
        `w_task_to_hl7_admitted`.`patient_zip_code` AS `patient_zip_code`,
        `w_task_to_hl7_admitted`.`patient_private_phone_number` AS `patient_private_phone_number`,
        `w_task_to_hl7_admitted`.`patient_phone_number` AS `patient_phone_number`,
        `w_task_to_hl7_admitted`.`patient_business_phone_number` AS `patient_business_phone_number`,
        `w_task_to_hl7_admitted`.`patient_mail` AS `patient_mail`,
        `w_task_to_hl7_admitted`.`patient_ssn_number` AS `patient_ssn_number`,
        `w_task_to_hl7_admitted`.`patient_location_code` AS `patient_location_code`,
        `w_task_to_hl7_admitted`.`patient_patient_status_code` AS `patient_patient_status_code`,
        `w_task_to_hl7_admitted`.`patient_identity_reliability_code` AS `patient_identity_reliability_code`,
        `w_task_to_hl7_admitted`.`patient_put_on_hold` AS `patient_put_on_hold`,
        `w_task_to_hl7_admitted`.`patient_last_called_at` AS `patient_last_called_at`,
        `w_task_to_hl7_admitted`.`patient_number_of_call` AS `patient_number_of_call`,
        `w_task_to_hl7_admitted`.`patient_created_at` AS `patient_created_at`,
        `w_task_to_hl7_admitted`.`patient_updated_at` AS `patient_updated_at`,
        `w_task_to_hl7_admitted`.`document_id` AS `document_id`,
        `w_task_to_hl7_admitted`.`document_patient_id` AS `document_patient_id`,
        `w_task_to_hl7_admitted`.`document_study_id` AS `document_study_id`,
        `w_task_to_hl7_admitted`.`document_name` AS `document_name`,
        `w_task_to_hl7_admitted`.`document_file_path` AS `document_file_path`,
        `w_task_to_hl7_admitted`.`document_alternative_file_path` AS `document_alternative_file_path`,
        `w_task_to_hl7_admitted`.`document_type_code` AS `document_type_code`,
        `w_task_to_hl7_admitted`.`document_type_name` AS `document_type_name`,
        `w_task_to_hl7_admitted`.`document_type_level` AS `document_type_level`,
        `w_task_to_hl7_admitted`.`document_created_at` AS `document_created_at`,
        `w_task_to_hl7_admitted`.`document_updated_at` AS `document_updated_at`,
        `w_task_to_hl7_admitted`.`form_filled_id` AS `form_filled_id`,
        `w_task_to_hl7_admitted`.`hl7_server_id` AS `hl7_server_id`,
        `w_task_to_hl7_admitted`.`hl7_server_application` AS `hl7_server_application`,
        `w_task_to_hl7_admitted`.`hl7_server_facility` AS `hl7_server_facility`,
        `w_task_to_hl7_admitted`.`hl7_server_ip` AS `hl7_server_ip`,
        `w_task_to_hl7_admitted`.`hl7_server_port` AS `hl7_server_port`,
        `w_task_to_hl7_admitted`.`visit_preadmit_number` AS `visit_preadmit_number`,
        `w_task_to_hl7_admitted`.`visit_admit_number` AS `visit_admit_number`,
        `w_task_to_hl7_admitted`.`visit_description` AS `visit_description`,
        `w_task_to_hl7_admitted`.`visit_patient_class` AS `visit_patient_class`,
        `w_task_to_hl7_admitted`.`identifiant_hl7` AS `identifiant_hl7`
    FROM
        `w_task_to_hl7_admitted`